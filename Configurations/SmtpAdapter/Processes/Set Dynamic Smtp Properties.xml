<?xml version="1.0"?>
<ESBMessagePipelineStorage xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>363819f1-6db5-47c0-a5d3-86a9113b8eef</Id>
  <Version>020161e5-ec06-43f6-a880-82b70d814c9f</Version>
  <BusinessFlows />
  <Description />
  <Name>Set Dynamic Smtp Properties</Name>
  <IsSystemObject>false</IsSystemObject>
  <IsEncrypted>true</IsEncrypted>
  <PipelineBlob>&lt;ESBMessagePipeline xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.neuronesb.com/pipelines/"&gt;&lt;Category i:nil="true" /&gt;&lt;Description i:nil="true" /&gt;&lt;GlobalProperties xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Name&gt;Set Dynamic Smtp Properties&lt;/Name&gt;&lt;Properties xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;ReferencedAssemblies xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" i:nil="true" /&gt;&lt;Steps&gt;&lt;ESBMessagePipelineStep xmlns:d3p1="http://schemas.neuronesb.com/pipelines/esb/" i:type="d3p1:EsbMessagePropertyTransformPipelineStep"&gt;&lt;Bindings xmlns:d4p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Name&gt;Set SMTP Properties&lt;/Name&gt;&lt;Uniquename&gt;eb50456e-1856-43d7-83a5-e35ebdfa244e&lt;/Uniquename&gt;&lt;d3p1:Expressions&gt;&lt;d3p1:Expression&gt;&lt;d3p1:Property&gt;smtp.To&lt;/d3p1:Property&gt;&lt;d3p1:Value&gt;"Logs@NeuronDemo.com"&lt;/d3p1:Value&gt;&lt;/d3p1:Expression&gt;&lt;d3p1:Expression&gt;&lt;d3p1:Property&gt;smtp.From&lt;/d3p1:Property&gt;&lt;d3p1:Value&gt;"Neuron@NeuronDemo.com"&lt;/d3p1:Value&gt;&lt;/d3p1:Expression&gt;&lt;d3p1:Expression&gt;&lt;d3p1:Property&gt;smtp.Subject&lt;/d3p1:Property&gt;&lt;d3p1:Value&gt;"Dynamic Smtp adapter properties test"&lt;/d3p1:Value&gt;&lt;/d3p1:Expression&gt;&lt;d3p1:Expression&gt;&lt;d3p1:Property&gt;smtp.IsBodyHtml&lt;/d3p1:Property&gt;&lt;d3p1:Value&gt;"true"&lt;/d3p1:Value&gt;&lt;/d3p1:Expression&gt;&lt;d3p1:Expression&gt;&lt;d3p1:Property&gt;smtp.BodyAsAttachment&lt;/d3p1:Property&gt;&lt;d3p1:Value&gt;"false"&lt;/d3p1:Value&gt;&lt;/d3p1:Expression&gt;&lt;d3p1:Expression&gt;&lt;d3p1:Property&gt;smtp.XpathAsAttachment&lt;/d3p1:Property&gt;&lt;d3p1:Value&gt;"/FAILURE/Document/text()"&lt;/d3p1:Value&gt;&lt;/d3p1:Expression&gt;&lt;d3p1:Expression&gt;&lt;d3p1:Property&gt;smtp.FileName&lt;/d3p1:Property&gt;&lt;d3p1:Value&gt;"FailedMessage.xml"&lt;/d3p1:Value&gt;&lt;/d3p1:Expression&gt;&lt;d3p1:Expression&gt;&lt;d3p1:Property&gt;smtp.XslTemplate&lt;/d3p1:Property&gt;&lt;d3p1:Value&gt;"FailureToHtml"&lt;/d3p1:Value&gt;&lt;/d3p1:Expression&gt;&lt;/d3p1:Expressions&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="ESBMessageCodePipelineStep"&gt;&lt;Bindings xmlns:d4p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;true&lt;/Disable&gt;&lt;Name&gt;Set Properties&lt;/Name&gt;&lt;Uniquename&gt;66b0f50c-a1f9-4c90-8ad4-a07002cb0898&lt;/Uniquename&gt;&lt;BreakPointLines xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;    // send an ESB Message with smtp adapter properties all dynamically declared
    // and using an XSL Transform stored in the Neuron respository to transform
    // the body to a different format, in this case HTML.  Also sending the original body 
	// as the attachment. If I set the BodyAsAttachment property to false,
    // than the serialized class would be the Body of the smtp message by default
					
	context.Data.SetProperty("smtp", "To", "Logs@NeuronDemo.com");
    context.Data.SetProperty("smtp", "From", "Neuron@NeuronDemo.com");
	context.Data.SetProperty("smtp", "Subject", "Dynamic Smtp adapter properties test");
    context.Data.SetProperty("smtp", "IsBodyHtml", "true");   
    context.Data.SetProperty("smtp", "BodyAsAttachment", "false");
	context.Data.SetProperty("smtp", "XpathAsAttachment", "/FAILURE/Document/text()");
    context.Data.SetProperty("smtp", "FileName", "FailedMessage.xml");
    context.Data.SetProperty("smtp", "XslTemplate", "FailureToHtml");
&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d4p1:string&gt;Neuron&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Neuron.Pipelines&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Neuron.Esb&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typeb2ac31eb84c4121b1754d82cbe73b2&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Steps&gt;&lt;/ESBMessagePipeline&gt;</PipelineBlob>
</ESBMessagePipelineStorage>